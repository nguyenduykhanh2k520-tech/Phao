<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <title>Ph√°o hoa üéÜ Click ƒë·ªÉ b·∫Øn</title>
    <style>
        body {
            margin: 0;
            overflow: hidden;
            background: black;
        }
        canvas { display: block; }
    </style>
</head>
<body>

<canvas id="canvas"></canvas>

<!-- TI·∫æNG PH√ÅO N·ªî -->
<audio id="boomSound" preload="auto">
    <source src="https://cdn.pixabay.com/download/audio/2021/08/04/audio_4f46c68a65.mp3?filename=firework-explosion-1-6001.mp3" type="audio/mp3">
</audio>

<script>
const canvas = document.getElementById("canvas");
const ctx = canvas.getContext("2d");
const boomSound = document.getElementById("boomSound");

// ===== UNLOCK AUDIO (B·∫ÆT BU·ªòC CHO CHROME) =====
let audioUnlocked = false;
document.body.addEventListener("click", () => {
    if (!audioUnlocked) {
        boomSound.play().then(() => {
            boomSound.pause();
            boomSound.currentTime = 0;
            audioUnlocked = true;
            console.log("√Çm thanh ƒë√£ m·ªü kh√≥a.");
        }).catch(() => {});
    }
}, { once: true });

canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

window.addEventListener("resize", () => {
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;
});

// ===== H·∫†T N·ªî =====
class Particle {
    constructor(x, y, color) {
        const angle = Math.random() * Math.PI * 2;
        const speed = Math.random() * 6 + 2;

        this.x = x;
        this.y = y;
        this.color = color;
        this.radius = Math.random() * 2 + 1;
        this.speedX = Math.cos(angle) * speed;
        this.speedY = Math.sin(angle) * speed;
        this.life = 120;
        this.opacity = 1;
    }

    update() {
        this.speedY += 0.05;
        this.x += this.speedX;
        this.y += this.speedY;
        this.life--;
        this.opacity -= 0.01;
    }

    draw() {
        ctx.save();
        ctx.globalAlpha = this.opacity;
        ctx.beginPath();
        ctx.arc(this.x, this.y, this.radius, 0, Math.PI * 2);
        ctx.fillStyle = this.color;
        ctx.fill();
        ctx.restore();
    }
}

// ===== PH√ÅO BAY L√äN =====
class Firework {
    constructor(x, y) {
        this.x = x;
        this.y = canvas.height;
        this.targetY = y;
        this.speedY = -8 - Math.random() * 3;
        this.exploded = false;
        this.color = "white";
    }

    update() {
        this.y += this.speedY;

        if (this.y <= this.targetY && !this.exploded) {
            this.explode();
        }
    }

    draw() {
        ctx.beginPath();
        ctx.arc(this.x, this.y, 3, 0, Math.PI * 2);
        ctx.fillStyle = this.color;
        ctx.fill();
    }

    explode() {
        this.exploded = true;

        if (audioUnlocked) {
            boomSound.currentTime = 0;
            boomSound.play();
        }

        const colors = ["#ff004c","#00eaff","#ffe600","#8cff00","#ff7b00","#b300ff","#ffffff"];
        const color = colors[Math.floor(Math.random() * colors.length)];

        for (let i = 0; i < 120; i++) {
            particles.push(new Particle(this.x, this.y, color));
        }
    }
}

let fireworks = [];
let particles = [];

function animate() {
    ctx.fillStyle = "rgba(0,0,0,0.15)";
    ctx.fillRect(0, 0, canvas.width, canvas.height);

    fireworks = fireworks.filter(f => !f.exploded);
    fireworks.forEach(f => { f.update(); f.draw(); });

    particles = particles.filter(p => p.life > 0 && p.opacity > 0);
    particles.forEach(p => { p.update(); p.draw(); });

    requestAnimationFrame(animate);
}

// ===== CLICK ‚Üí B·∫ÆN PH√ÅO =====
canvas.addEventListener("click", e => {
    fireworks.push(new Firework(e.clientX, e.clientY));
});

animate();
</script>

</body>
</html>
